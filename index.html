<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Γραμματική</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div id="cards-container">
            <div class="question-section active">
                <div class="content-box">
                    <img src="grammar_q.svg" alt="Question Card" class="card-background">
                    <div class="card-text question-text">
                        <h2 class="section-title">ΕΡΩΤΗΣΗ</h2>
                        <div class="text-area"></div>
                    </div>

                    <form id="questionForm" class="input-area">
                        <label class="input-label">Σημείωσε την απάντηση σου:</label>
                        <input type="text" class="input-box" required>
                        <button type="submit" class="submit-btn">Υποβολή</button>
                    </form>
                </div>
            </div>
            <div class="answer-section">
                <div class="content-box">
                    <img src="grammar_a.svg" alt="Answer Card" class="card-background">
                    <div class="card-text answer-text">
                        <h2 class="section-title">ΑΠΑΝΤΗΣΗ</h2>
                        <div class="text-area"></div>
                    </div>

                    <div class="answer-content">
                        <button id="nextButton" class="next-btn">Επόμενη ερώτηση</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        let currentQuestionIndex = 0;
        let questions = [];

        // Fetch questions from JSON file
        async function loadQuestions() {
            try {
                const response = await fetch('questions.json');
                const data = await response.json();
                questions = data.questions;
                if (questions.length > 0) {
                    displayQuestion(0);
                    document.querySelector('.question-section').classList.add('active');
                } else {
                    alert('Δεν βρέθηκαν ερωτήσεις.');
                }
            } catch (error) {
                console.error('Error loading questions:', error);
                alert('Σφάλμα κατά τη φόρτωση των ερωτήσεων.');
            }
        }

        // Display current question
        function displayQuestion(index) {
            if (index >= questions.length) {
                return;
            }
            
            const q = questions[index];
            // fill question card
            const qText = document.querySelector('.question-section .question-text .text-area');
            const aText = document.querySelector('.answer-section .answer-text .text-area');
            qText.textContent = q.question;
            aText.textContent = q.answer;

            // Remove any previous user answer from the answer card
            const prevUser = document.querySelectorAll('.answer-section .answer-text .user-answer');
            prevUser.forEach(n => n.remove());

            // Reset form (input under the question)
            const form = document.getElementById('questionForm');
            const input = form.querySelector('input');
            const btn = form.querySelector('button');
            input.value = '';
            input.disabled = false;
            btn.disabled = false;

            // Update next button text if it's the last question
            const nextButton = document.getElementById('nextButton');
            nextButton.textContent = index === questions.length - 1 ? 'Τέλος' : 'Επόμενη ερώτηση';
        }

        // Handle form submission
        document.getElementById('questionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const answer = this.querySelector('input').value;
            if (answer.trim() !== '') {
                // show answer card (answer text is already filled from JSON)
                document.querySelector('.question-section').classList.remove('active');
                document.querySelector('.answer-section').classList.add('active');
                this.querySelector('input').disabled = true;
                this.querySelector('button').disabled = true;
                // optionally display user's typed answer somewhere on the answer card
                const userAns = document.querySelector('.answer-section .answer-text .text-area');
                // append user's answer below the official answer
                const userDiv = document.createElement('div');
                userDiv.className = 'user-answer';
                userDiv.textContent = 'Η απάντησή σου: ' + answer;
                userDiv.style.marginTop = '8px';
                userDiv.style.fontStyle = 'italic';
                userDiv.style.color = '#333';
                userAns.appendChild(userDiv);
            }
        });

        // Handle next button click
        document.getElementById('nextButton').addEventListener('click', function() {
            currentQuestionIndex++;
            if (currentQuestionIndex >= questions.length) {
                // End of questions
                alert('Συγχαρητήρια! Ολοκληρώσατε όλες τις ερωτήσεις.');
                // Optional: Reset to first question
                currentQuestionIndex = 0;
                displayQuestion(currentQuestionIndex);
            }
            
            // Show next question
            document.querySelector('.question-section').classList.add('active');
            document.querySelector('.answer-section').classList.remove('active');
            displayQuestion(currentQuestionIndex);
        });

        // Start loading questions when page loads
        document.addEventListener('DOMContentLoaded', loadQuestions);
    </script>
</body>
</html>
